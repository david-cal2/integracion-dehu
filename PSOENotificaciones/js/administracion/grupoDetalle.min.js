var $table = $("#table"), $tablaUsu = $("#tablaUsuarios"), $tablaOrg = $("#tablaOrganismos"), $tableTodosUsu = $("#tableTodosUsuarios"), $tablaTodosOrg = $("#tableTodosOrganismos");
$(function () {
    function f() { $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/GetDetalleGrupo", dataType: "json", data: { id: idGrupoEditado }, success: function (a) { a.hasOwnProperty("responseText") ? toastr.error("Error en la llamada al servicio 'GetDetalleGrupo'") : ($("#tituloGrupo")[0].innerText = a.Descripcion, $("#txtNombre")[0].value = a.Nombre, $("#txtDescripcion")[0].value = a.Descripcion) }, error: function (a) { toastr.error("Error en la llamada al servicio 'GetDetalleGrupo'") } }) }
    function c() { $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/CargarUsuarioPorGrupos", dataType: "json", data: { id: idGrupoEditado }, success: function (a) { $tablaUsu.bootstrapTable("removeAll"); $tablaUsu.bootstrapTable("load", a) }, error: function (a) { toastr.error("Error en la llamada al servicio 'CargarUsuarioPorGrupos'") } }) } function g() {
        $.ajax({
            async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/GetUsuarios", dataType: "json", success: function (a) {
                $tableTodosUsu.bootstrapTable("removeAll");
                $tableTodosUsu.bootstrapTable("load", a)
            }, error: function (a) { toastr.error("Error en la llamada al servicio 'GetUsuarios'") }
        })
    } function d() { $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/CargarOrganismoPorId", dataType: "json", data: { id: idGrupoEditado }, success: function (a) { $tablaOrg.bootstrapTable("removeAll"); $tablaOrg.bootstrapTable("load", a); $("#regPagina").text("Organismos por p\u00e1gina") }, error: function (a) { toastr.error("Error en la llamada al servicio 'CargarOrganismoPorId'") } }) }
    function h(a) { $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/AsignarOrgGrupo", dataType: "json", data: { idOrg: a, idGrupo: idGrupoEditado }, success: function (b) { "Ya existe" == b.responseText ? ($("#overlay").hide(), $("#mensaje").text("El Organismo ya pertenece al grupo"), $("#alertModal").modal("show")) : (d(idGrupoEditado), $("#overlay").hide(), toastr.success("Organismo agregado correctamente")) }, error: function (b) { toastr.error("Error en la llamada al servicio 'AsignarOrgGrupo'") } }) }
    function k(a) { $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/EliminarOrganismoGrupo", dataType: "json", data: { idOrgGrupo: a }, success: function (b) { d(idGrupoEditado); $("#overlay").hide(); toastr.success("Organismo eliminado correctamente") }, error: function (b) { toastr.error("Error en la llamada al servicio 'EliminarOrganismoGrupo'") } }) } $(document).ready(function () { f(); c(); d() }); $("#btnAceptar").click(function (a) {
        a.preventDefault(); a = $("#txtNombre").val(); var b =
            $("#txtDescripcion").val(); "" == a ? ($("#mensaje").text("El campo nombre es obligatorio"), $("#alertModal").modal("show")) : $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/InsertarEditarGrupo", dataType: "json", data: { id: idGrupoEditado, nombre: a, descripcion: b }, success: function (e) { e.hasOwnProperty("responseText") ? toastr.error("Error en la llamada al servicio 'InsertarEditarGrupo'") : toastr.success("Detalle grabado correctamente") }, error: function (e) { toastr.error("Error en la llamada al servicio 'InsertarEditarGrupo'") } })
    });
    $("#btnAgregarUsuario").click(function (a) { a.preventDefault(); $("#conTodosUsuarios").show(); g() }); $("#btnAgregarOrganismo").click(function (a) { $("#conTodosOrganismos").show(); window.scrollTo(0, document.body.scrollHeight) }); $("#tableTodosUsuarios tbody").on("click", "#spanAsignar", function () {
        var a = $(this).closest("tr").find("td:nth-child(1)").text(); $.ajax({
            async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/AsignarUsuarioGrupo", dataType: "json", data: { idUsu: a, idGrupo: idGrupoEditado },
            success: function (b) { "Ya existe" == b.responseText ? ($("#mensaje").text("El usuario ya pertenece al grupo"), $("#alertModal").modal("show")) : c(idGrupoEditado) }, error: function (b) { toastr.error("Error en la llamada al servicio 'AsignarUsuarioGrupo'") }
        })
    }); $("#tablaUsuarios tbody").on("click", "#spanEliminar", function () {
        var a = $(this).closest("tr").find("td:nth-child(1)").text(); $.ajax({
            async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Administracion/EliminarUsuarioGrupo", dataType: "json",
            data: { idUsuGrupo: a }, success: function (b) { c(idGrupoEditado) }, error: function (b) { toastr.error("Error en la llamada al servicio 'EliminarUsuarioGrupo'") }
        })
    }); $("#tableTodosOrganismos tbody").on("click", "#spanAsignarOrg", function () { var a = $(this).closest("tr").find("td:nth-child(1)").text(); $("#overlay").show(); setTimeout(h, 100, a) }); $("#tablaOrganismos tbody").on("click", "#spanEliminarOrg", function () { var a = $(this).closest("tr").find("td:nth-child(1)").text(); $("#overlay").show(); setTimeout(k, 100, a) })
});