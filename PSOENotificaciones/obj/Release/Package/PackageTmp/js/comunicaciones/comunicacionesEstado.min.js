var $inputIdentificador = $("#inputIdentificador"), $selectAdministracionPublica = $("#selectAdministracionPublica"), $selectOrganismosRaiz = $("#selectOrganismosRaiz"), $selectOrganismosEmisores = $("#selectOrganismosEmisores"), $selectAsuntos = $("#selectAsuntos"), $selectGrupos = $("#selectGrupos"), $selectGruposModal = $("#selectGruposModal");
$(function () {
    function l() { var f = []; f.push(parseInt(idEstado)); return f } (function () { var f = $("#item-menu-comunicaciones-estado-1"), k = $("#item-menu-comunicaciones-estado-3"), g = $("#item-menu-comunicaciones-estado-6"); idPerfil == Perfiles.Asignador && (k.addClass("no-visible"), g.addClass("no-visible")); idPerfil == Perfiles.Gestor && f.addClass("display-none"); $(".menu-lateral").removeClass("no-visible") })(); $(document).ready(function () {
        function f() {
            idPerfil != Perfiles.Asignador && idPerfil != Perfiles.UsuarioConsulta ||
            $(".btn-comparecer").addClass("display-none"); idPerfil != Perfiles.Gestor && idPerfil != Perfiles.UsuarioConsulta || $(".btn-abrir-modal-asignar-grupo").addClass("display-none"); idPerfil != Perfiles.Gestor && idPerfil != Perfiles.Asignador || $("#div-asignada").addClass("display-none"); idEstado == Estados.SinAsignar && ($("#liSinAsignar").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_pendiente")); idEstado == Estados.Asignadas && ($("#liAsignadas").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_asignadas"));
            idEstado == Estados.Leidas && ($("#liLeidas").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_comparecidas"))
        } function k() {
            for (var a = "", d = document.querySelectorAll("#gruposAsignados li"), e = 0; li = d[e]; e++)a += li.id + ","; $.ajax({
                async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Notificaciones/AsignarGrupoEnvio", data: { identificador: identificadorAsignar, idGrupos: a }, dataType: "json", success: function (b) {
                    "True" == b.Success ? ($(".cadena-" + identificadorAsignar)[0].innerText =
                        b.cadenaGrupos, g(), f()) : ($("#overlay").hide(), toastr.error("Error en la llamada al servicio 'AsignarGrupoEnvio'"))
                }, error: function (b) { $("#overlay").hide(); toastr.error("Error en la llamada al servicio 'AsignarGrupoEnvio'") }
            })
        } function g(a) {
            var d = "/Comunicaciones/GetComunicacionesBuscadorComplejo", e = !1; null == a && (e = !0, d = "/Comunicaciones/GetComunicacionesPorEstado", a = { idEstados: JSON.stringify(l()), primeros: !0 }); $.ajax({
                async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: d, data: a, dataType: "json",
                success: function (b) {
                    if (e && null != b.CantidadesTotales) { var c = $("#cantSinAsignar"), h = $("#cantAsignadas"), m = $("#cantLeidas"); c[0].innerHTML = b.CantidadesTotales[0].Value; h[0].innerHTML = b.CantidadesTotales[2].Value; m[0].innerHTML = b.CantidadesTotales[5].Value } c = $("#div-contenedor"); h = $("#div-contenedor-vacio"); null != b.ListaEnvios && 0 < b.ListaEnvios.length ? (c.removeClass("display-none"), h.addClass("display-none"), c = $("#table"), c.bootstrapTable("removeAll"), c.bootstrapTable("load", b.ListaEnvios), export_fileName =
                        "Comunicaciones", $("#regPagina").text("Comunicaciones por p\u00e1gina")) : (h.removeClass("display-none"), c.addClass("display-none")); $("#overlay").hide()
                }, error: function (b) { $("#overlay").hide(); toastr.error("Error en la llamada al servicio '" + d + "'") }
            })
        } setTimeout(cargarSelectAdministracionPublica, 500); setTimeout(cargarSelectAsuntos, 500); setTimeout(cargarSelectGrupos, 500); g(); f(); $("#btn-buscar").click(function (a) {
            a.preventDefault(); "" == $inputIdentificador.val() && "" == $selectAdministracionPublica.val() &&
                "" == $selectOrganismosRaiz.val() && "" == $selectOrganismosEmisores.val() && "" == $selectAsuntos.val() && "" == $selectGrupos.val() && "" == $fechaDesde.val() && "" == $fechaHasta.val() ? setTimeout(g, 1) : (a = {
                    idEstados: JSON.stringify(l()), identificador: "" == $inputIdentificador.val() ? null : $inputIdentificador.val(), administracionPublica: "" == $selectAdministracionPublica.val() ? null : $selectAdministracionPublica.val(), organismoRaiz: "" == $selectOrganismosRaiz.val() ? null : $selectOrganismosRaiz.val(), idOrganoEmisor: "" == $selectOrganismosEmisores.val() ?
                        null : $selectOrganismosEmisores.val(), asunto: "" == $selectAsuntos.val() ? null : $selectAsuntos.val(), idGrupo: "" == $selectGrupos.val() ? null : $selectGrupos.val(), fechaDesde: "" == $fechaDesde.val() ? null : $fechaDesde.val(), fechaHasta: "" == $fechaHasta.val() ? null : $fechaHasta.val()
                }, setTimeout(g, 1, a)); $("#overlay").show()
        }); $("#btn-limpiar").click(function (a) {
            $("#inputIdentificador")[0].value = ""; $("#selectAdministracionPublica").selectpicker("val", ""); cargarSelectOrganismoRaiz(""); cargarSelectOrganismosEmisores("");
            $("#selectAsuntos").selectpicker("val", ""); $("#selectGrupos").selectpicker("val", ""); $("#fechaDesde")[0].value = ""; $("#fechaHasta")[0].value = ""
        }); $("#table").on("dbl-click-cell.bs.table", function (a, d, e, b) { window.location.href = b.EstadosEnvio.ID != Estados.Leidas ? "../Comunicaciones/ComunicacionDetalle?identificador=" + b.Identificador + "&c=0" : "../Comunicaciones/ComunicacionLeida?identificador=" + b.Identificador }); $("#btn-agregar-grupo").click(function (a) {
            a = $("#selectGruposModal").val(); if ("" != a) {
                for (var d =
                    1, e = document.querySelectorAll("#gruposAsignados li"), b = 0; li = e[b]; b++)li.id == a && (d = 0); 1 == d && $.ajax({ async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Base/GetGrupoById", data: { idGrupo: a }, dataType: "json", success: function (c) { $("#gruposAsignados").append("<li id='" + c.ID + "'><strong class='eliminar-grupo' title='Quitar' onclick=\"javascript:eliminarGrupoAsignado('" + c.ID + "')\">X</strong>" + c.Nombre + "</li>") }, error: function (c) { toastr.error("Error en la llamada al servicio 'GetGrupoById'") } })
            }
        });
        $("#btn-guardar-grupos").click(function (a) { a.preventDefault(); $("#asignarGrupoModal").modal("hide"); setTimeout(k, 1); $("#overlay").show() })
    })
});