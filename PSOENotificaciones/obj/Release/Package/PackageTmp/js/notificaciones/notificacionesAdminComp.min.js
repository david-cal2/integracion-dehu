var $inputIdentificador = $("#inputIdentificador"), $selectAdministracionPublica = $("#selectAdministracionPublica"), $selectOrganismosRaiz = $("#selectOrganismosRaiz"), $selectOrganismosEmisores = $("#selectOrganismosEmisores"), $selectAsuntos = $("#selectAsuntos"), $selectGrupos = $("#selectGrupos"), $selectGruposModal = $("#selectGruposModal");
$(function () {
    function k() {
        for (var a = "", d = document.querySelectorAll("#gruposAsignados li"), e = 0; li = d[e]; e++)a += li.id + ","; $.ajax({
            async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Notificaciones/AsignarGrupoEnvio", data: { identificador: identificadorAsignar, idGrupos: a }, dataType: "json", success: function (b) { "True" == b.Success ? ($(".cadena-" + identificadorAsignar)[0].innerText = b.cadenaGrupos, $("#overlay").hide()) : ($("#overlay").hide(), toastr.error("Error en la llamada al servicio 'AsignarGrupoEnvio'")) },
            error: function (b) { $("#overlay").hide(); toastr.error("Error en la llamada al servicio 'AsignarGrupoEnvio'") }
        })
    } function g(a) {
        var d = "/Notificaciones/GetNotificacionesBuscadorComplejo", e = !1; null == a && (e = !0, d = "/Notificaciones/GetNotificacionesPorEstado", a = { idEstados: JSON.stringify(h()), primeros: !0 }); $.ajax({
            async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: d, data: a, dataType: "json", success: function (b) {
                e && null != b.CantidadesTotales && ($("#cantSinAsignar")[0].innerHTML = b.CantidadesTotales[0].Value,
                    $("#cantEnAlerta")[0].innerHTML = b.CantidadesTotales[1].Value, $("#cantAsignadas")[0].innerHTML = b.CantidadesTotales[2].Value, $("#cantComparecidas")[0].innerHTML = b.CantidadesTotales[3].Value, $("#cantCaducadas")[0].innerHTML = b.CantidadesTotales[4].Value, $("#cantExternas")[0].innerHTML = b.CantidadesTotales[6].Value); var c = $("#div-contenedor"), f = $("#div-contenedor-vacio"); null != b.ListaEnvios && 0 < b.ListaEnvios.length ? (c.removeClass("display-none"), f.addClass("display-none"), c = $("#table"), c.bootstrapTable("removeAll"),
                        c.bootstrapTable("load", b.ListaEnvios), export_fileName = "Notificaciones", $("#regPagina").innerText = "Notificaciones por p\u00e1gina") : (f.removeClass("display-none"), c.addClass("display-none")); $("#overlay").hide()
            }, error: function (b) { $("#overlay").hide(); toastr.error("Error en la llamada al servicio '" + d + "'") }
        })
    } function l() {
        $.ajax({
            async: !1, type: "GET", contentType: "application/json; charset=utf-8", url: "/Notificaciones/GetCantidadEnviosComparecida", dataType: "json", success: function (a) {
                null != a.CantidadesTotales &&
                ($("#cantSinAsignar")[0].innerHTML = a.CantidadesTotales[0].Value, $("#cantEnAlerta")[0].innerHTML = a.CantidadesTotales[1].Value, $("#cantAsignadas")[0].innerHTML = a.CantidadesTotales[2].Value, $("#cantComparecidas")[0].innerHTML = a.CantidadesTotales[3].Value, $("#cantCaducadas")[0].innerHTML = a.CantidadesTotales[4].Value, $("#cantExternas")[0].innerHTML = a.CantidadesTotales[6].Value)
            }, error: function (a) { toastr.error("Error en la llamada al servicio 'GetCantidadEnviosComparecida'") }
        })
    } function h() {
        var a = []; a.push(parseInt(idEstado));
        return a
    } (function () { var a = $("#item-menu-notificaciones-estado-1"), d = $("#item-menu-notificaciones-estado-2"), e = $("#item-menu-notificaciones-estado-3"), b = $("#item-menu-notificaciones-estado-4"), c = $("#item-menu-notificaciones-estado-5"), f = $("#item-menu-notificaciones-estado-7"); idPerfil == Perfiles.Asignador && (d.addClass("no-visible"), e.addClass("no-visible"), b.addClass("no-visible"), c.addClass("no-visible"), f.addClass("no-visible")); idPerfil == Perfiles.Gestor && a.addClass("display-none"); $(".menu-lateral").removeClass("no-visible") })();
    $(document).ready(function () {
        $("#overlay").hide(); setTimeout(cargarSelectAdministracionPublica, 500); setTimeout(cargarSelectAsuntos, 500); setTimeout(cargarSelectGrupos, 500); idPerfil != Perfiles.Asignador && idPerfil != Perfiles.UsuarioConsulta || $(".btn-comparecer").addClass("display-none"); idPerfil != Perfiles.Gestor && idPerfil != Perfiles.UsuarioConsulta || $(".btn-abrir-modal-asignar-grupo").addClass("display-none"); idPerfil != Perfiles.Gestor && idPerfil != Perfiles.Asignador || $("#div-asignada").addClass("display-none");
        idEstado == Estados.SinAsignar && ($("#liSinAsignar").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_pendiente")); idEstado == Estados.EnAlerta && ($("#liEnAlerta").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_alerta")); idEstado == Estados.Asignadas && ($("#liAsignadas").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_asignadas")); idEstado == Estados.Comparecidas && ($("#liComparecidas").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_comparecidas"));
        idEstado == Estados.Caducadas && ($("#liCaducadas").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_caducadas")); idEstado == Estados.Externas && ($("#liExternas").addClass("active_menu"), $(".content_title__menu").addClass("content_title__menu_externas")); l(); $("#btn-buscar").click(function (a) {
            a.preventDefault(); "" == $inputIdentificador.val() && "" == $selectAdministracionPublica.val() && "" == $selectOrganismosRaiz.val() && "" == $selectOrganismosEmisores.val() && "" == $selectAsuntos.val() &&
                "" == $selectGrupos.val() && "" == $fechaDesde.val() && "" == $fechaHasta.val() ? setTimeout(g, 1) : (a = {
                    idEstados: JSON.stringify(h()), identificador: "" == $inputIdentificador.val() ? null : $inputIdentificador.val(), administracionPublica: "" == $selectAdministracionPublica.val() ? null : $selectAdministracionPublica.val(), organismoRaiz: "" == $selectOrganismosRaiz.val() ? null : $selectOrganismosRaiz.val(), idOrganoEmisor: "" == $selectOrganismosEmisores.val() ? null : $selectOrganismosEmisores.val(), asunto: "" == $selectAsuntos.val() ? null : $selectAsuntos.val(),
                    idGrupo: "" == $selectGrupos.val() ? null : $selectGrupos.val(), fechaDesde: "" == $fechaDesde.val() ? null : $fechaDesde.val(), fechaHasta: "" == $fechaHasta.val() ? null : $fechaHasta.val()
                }, setTimeout(g, 1, a)); $("#overlay").show()
        }); $("#btn-limpiar").click(function (a) {
            $("#inputIdentificador")[0].value = ""; $("#selectAdministracionPublica").selectpicker("val", ""); cargarSelectOrganismoRaiz(""); cargarSelectOrganismosEmisores(""); $("#selectAsuntos").selectpicker("val", ""); $("#selectGrupos").selectpicker("val", ""); $("#fechaDesde")[0].value =
                ""; $("#fechaHasta")[0].value = ""
        }); $("#table").on("dbl-click-cell.bs.table", function (a, d, e, b) { window.location.href = b.EstadosEnvio.ID != Estados.Comparecidas ? "../Notificaciones/NotificacionDetalle?identificador=" + b.Identificador + "&c=0" : "../Notificaciones/NotificacionComparecida?identificador=" + b.Identificador }); $("#btn-agregar-grupo").click(function (a) {
            a = $("#selectGruposModal").val(); if ("" != a) {
                for (var d = 1, e = document.querySelectorAll("#gruposAsignados li"), b = 0; li = e[b]; b++)li.id == a && (d = 0); 1 == d && $.ajax({
                    async: !1,
                    type: "GET", contentType: "application/json; charset=utf-8", url: "/Base/GetGrupoById", data: { idGrupo: a }, dataType: "json", success: function (c) { $("#gruposAsignados").append("<li id='" + c.ID + "'><strong class='eliminar-grupo' title='Quitar' onclick=\"javascript:eliminarGrupoAsignado('" + c.ID + "')\">X</strong>" + c.Nombre + "</li>") }, error: function (c) { toastr.error("Error en la llamada al servicio 'GetGrupoById'") }
                })
            }
        }); $("#btn-guardar-grupos").click(function (a) {
            a.preventDefault(); $("#asignarGrupoModal").modal("hide");
            setTimeout(k, 1); $("#overlay").show()
        })
    })
});